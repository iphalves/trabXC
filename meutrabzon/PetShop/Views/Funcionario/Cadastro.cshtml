@section estilos {
    <link href="~/css/Login/Index.css" rel="stylesheet" />
    <link href="~/lib/fancybox/jquery.fancybox.css" rel="stylesheet" />
}
@{
    ViewBag.Titulo = "Cadastra Funcionario";
    ViewBag.Msg = "Cadastra Funcionario";
}
@section js {
    <script src="~/lib/fancybox/jquery.fancybox.js"></script>
    <script>
        id = 0;
        resp = "";
        response = "";
        var cadastro = {

            init: function () {
                y.onclick("btnSalvar", cadastro.btnSalvarOnClick);
                y.onclick("btnDeletar", cadastro.btnDeletarOnClick);
                y.onclick("btnCancelar", cadastro.btnCancelarOnClick);
                y.onclick("btnPesquisar", cadastro.btnPesquisarOnClick);
            },
            btnSalvarOnClick: function () {
                dialog.confirm("Cadastrar usuario", function () { 

                   cadastro.btnSalvarOnClick2();

                });
                
            },
            btnSalvarOnClick2: function () {

                if (!validation.formIsValid()) {
                    return;

                }
                var dados = {
                    id: id,
                    nome: y.byId("nomeCompleto").value,
                    cpf: y.byId("cpf").value,
                    rg: y.byId("rg").value,
                    sexo: y.byId("sexo").value,
                    senha: y.byId("senha").value
                }

                y.ajax(dados, "/Funcionario/Cadastrar", "POST",
                    function (retServ) {
                        if (!retServ.operacao) {
                            y.byId("divMsg").innerHTML = retServ.msg;
                        }
                        else y.byId("divMsg").innerHTML = "Sucesso....";

                    },
                    function () {

                        alert("deu erro...");

                    });

            },
            btnCancelarOnClick: function () {
                window.href.location = window.href.location;

            },

            btnDeletarOnClick: function () {
                var dados = {
                    id: id,
                }
                y.ajax(dados, "/Funcionario/Deletar", "POST", function (retServ) {
                    if (!retServ.operacao) {
                        y.byId("divMsg").innerHTML = retServ.msg;
                    }
                    else y.byId("divMsg").innerHTML = "Funcionario deletado com sucesso!";
                },
                    function () { alert("algum erro aconteceu!"); })
            },


            btnPesquisarOnClick: function () {

                $.fancybox.open({
                    src: "/Funcionario/Pesquisar",
                    type: 'iframe',
                    iframe: {
                        css: {
                            'min-width': '400px',
                            'max-width': '600px',
                            'height': '500px'
                        }
                    }

                });
            },

            editar: function (id) {

                $.fancybox.close();

                var dados = {
                    id: id
                }

                y.ajax(dados, "/funcionario/ObterPorId", "POST", function (retServ) {

                    y.byId("senha").disabled = "disabled";
                    cadastro.id = retServ.id;
                    y.byId("nome").value = retServ.nomeCompleto;
                    y.byId("nomeUsuario").value = retServ.nomeUsuario;

                }, function () {
                    alert("Não foi possível obter o funcionário");
                });

            },


            btnCancelarOnClick: function () {

                window.location.href = window.location.href;

            },

        }

        document.addEventListener("DOMContentLoaded", function () {

            cadastro.init();

        });
        
        
        
    </script>
    <style>
        .invalid{
            font-size: 12px;
            color: red;
        }

        .inputInvalid {
            border-bottom: 1px dashed red !important;
            border-top: 1px dashed red !important;
            border-left: 1px dashed red !important;
            border-right: 1px dashed red !important;
        }
        #divMsg{
            color:darkslateblue !important;
        }
    </style>
}
    <section>
        <div class="container">
            <div class="col-md-12">
                <div class="panel-heading text-left">
                    <h3 class="panel-title title-login">> Cadastro de usuário</h3>
                    <hr />
                </div>
                <form>
                    <input type="hidden" name="actionDialog" value="" />
                    <div class="container-fluid ">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label>Informe nome completo:</label>
                                            <input data-validation-required="Informe o nome completo."
                                                   data-validation-summary="msgNome" class="form-control" id="nomeCompleto" placeholder="Nome Completo" name="nomeCompleto" type="text">
                                            <span class="invalid" id="msgNome" />
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label>Informe o rg:</label>
                                            <input data-validation-required="Informe o RG" data-validation-summary="msgRG" class="form-control" id="rg" placeholder="RG" name="rg" type="text" maxlength="9">
                                            <span class="invalid" id="msgRG" />
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label>Informe cpf:</label>
                                            <input data-validation-cpf="CPF Inválido"
                                                   data-validation-required="Informe o CPF"
                                                   data-validation-summary="msgCPF" class="form-control" id="cpf" placeholder="CPF" name="cpf" type="text" maxlength="11">
                                            <span class="invalid" id="msgCPF" />
                                        </div>
                                    </div>

                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label>Selecione o sexo:</label>
                                            <select id="sexo" name="sexo" class="form-control">
                                                <option value="M">M - Masculino</option>
                                                <option value="F">F - Feminino</option>
                                            </select>
                                        </div>
                                    </div>


                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label>Digite a senha:</label>
                                            <input data-validation-required="Informe a Senha"
                                                   data-validation-summary="msgSenha" class="form-control" id="senha" placeholder="Senha" name="senha" type="password">
                                            <span class="invalid" id="msgSenha" />
                                        </div>
                                        <div>&nbsp;</div>
                                    </div>
                                    <div id="divMsg"></div>
                                </div>
                                <div class="btn-group pull-right" role="group">
                                    <input class="btn btn-custom" id="btnSalvar" type="button" value="Cadastrar" />&nbsp;
                                    <input class="btn btn-custom" id="btnDeletar" type="button" value="Deletar" />&nbsp;
                                    <input class="btn btn-custom" id="btnCancelar" type="button" value="Cancelar" />&nbsp;
                                    <input class="btn btn-custom" id="btnPesquisar" type="button" value="Pesquisar" />&nbsp;
                                </div>

                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <div class="clearfix">&nbsp;</div>
    </section>